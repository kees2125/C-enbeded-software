<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">ethernut-4.3.3</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_000001.html">nut</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_000032.html">fs</a></div>
<h1>phatdir.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
PHAT File System. 
<p>
<div class="fragment"><pre class="fragment"> *
 * $Log: phatdir.c,v $
 * Revision 1.11  2006/10/08 16:42:56  haraldkipp
 * Not optimal, but simple and reliable exclusive access implemented.
 * Fixes bug #1486539. Furthermore, bug #1567790, which had been rejected,
 * had been reported correctly and is now fixed.
 *
 * Revision 1.10  2006/10/05 17:23:14  haraldkipp
 * Fixes bug #1571269. Thanks to Dirk Boecker for reporting this.
 *
 * Revision 1.9  2006/09/08 16:48:28  haraldkipp
 * Directory entries honor daylight saving time. Thanks to Dirk Boecker for
 * this fix.
 *
 * Revision 1.8  2006/07/05 16:00:30  haraldkipp
 * Two bugs fixed. Renaming a file's path (including directory change) failed.
 * Thanks to Dirk Boecker, who reported this.
 * The second bug was a memory hole, which had been discovered by
 * Ralf Spettel.
 *
 * Revision 1.7  2006/06/28 17:24:29  haraldkipp
 * Bugfix. Directories with long filename entries may not expand when
 * crossing cluster boundaries.
 *
 * Revision 1.6  2006/06/18 16:37:10  haraldkipp
 * No need to set errno after GetParentPath() returns an error.
 * No need to set errno after malloc failed.
 * New local helper function PhatOpenParentPath() reduces code size.
 * Support for long filenames (VFAT) added.
 * New function PhatDirReleaseChain() simplifies code.
 * Static function PhatDirOpenParentPath() replaced by global PhatDirOpenParent().
 * Added const attribute to path parameter of PhatDirOpen().
 * Now PhatDirEntryUpdate() clears the dirty flag for the root directory.
 * Calls to PhatFilePosSet() with position zero replaced by calls to PhatFilePosRewind().
 *
 * Revision 1.5  2006/04/07 12:52:24  haraldkipp
 * Memory hole fixed. Flag for normal / directory files now set correctly.
 *
 * Revision 1.4  2006/02/23 15:45:21  haraldkipp
 * PHAT file system now supports configurable number of sector buffers.
 * This dramatically increased write rates of no-name cards.
 * AVR compile errors corrected.
 *
 * Revision 1.3  2006/01/25 18:47:42  haraldkipp
 * Fixes wrong implementation of readdir() and simplifies the code.
 * Thanks to Jesper Hansen.
 *
 * Revision 1.2  2006/01/22 17:40:51  haraldkipp
 * Now mkdir() fails, if the directory exists already.
 * Now rmdir() returns an error when trying to delete subdirectories, which
 * are not empty.
 * Now PhatDirEntryStatus() sets correct errno value, if out of memory.
 *
 * Revision 1.1  2006/01/05 16:31:32  haraldkipp
 * First check-in.
 *
 *
 * </pre></div>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ga23"></a><!-- doxytag: member="phatdir.c::PHAT_MAXDIRENT" ref="ga23" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga23">PHAT_MAXDIRENT</a>&nbsp;&nbsp;&nbsp;65536</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum number of directory entries. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga7">PhatDirEntryCreate</a> (<a class="el" href="struct__NUTFILE.html">NUTFILE</a> *ndp, CONST char *name, int acc, <a class="el" href="struct__PHATDIRENT.html">PHATDIRENT</a> *<a class="el" href="structdirent.html">dirent</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new directory entry.  <a href="group__xgPhatDir.html#ga7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga8">PhatDirEntryUpdate</a> (<a class="el" href="struct__NUTFILE.html">NUTFILE</a> *nfp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update directory entry of an opened file or directory.  <a href="group__xgPhatDir.html#ga8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga10">PhatDirEntryFind</a> (<a class="el" href="struct__NUTFILE.html">NUTFILE</a> *ndp, CONST char *spec, <a class="el" href="group__xgNutOS.html#ga3">u_long</a> attmsk, PHATFIND *srch)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a directory entry with a specified name.  <a href="group__xgPhatDir.html#ga10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__NUTFILE.html">NUTFILE</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga11">PhatDirOpenParent</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, CONST char *path, CONST char **basename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Open parent directory of a given path.  <a href="group__xgPhatDir.html#ga11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga12">PhatDirRenameEntry</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, CONST char *old_path, CONST char *new_path)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rename file.  <a href="group__xgPhatDir.html#ga12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga13">PhatDirReleaseChain</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, <a class="el" href="struct__PHATDIRENT.html">PHATDIRENT</a> *dent)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release a cluster chain of a specified directory entry.  <a href="group__xgPhatDir.html#ga13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga14">PhatDirDelEntry</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, CONST char *path, <a class="el" href="group__xgNutOS.html#ga3">u_long</a> flags)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a directory entry.  <a href="group__xgPhatDir.html#ga14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__NUTFILE.html">NUTFILE</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga15">PhatDirOpen</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, CONST char *dpath)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Open a directory.  <a href="group__xgPhatDir.html#ga15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga16">PhatDirRead</a> (<a class="el" href="struct__dirdesc.html">DIR</a> *dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read the next directory entry.  <a href="group__xgPhatDir.html#ga16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga17">PhatDirCreate</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, char *path)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new subdirectory.  <a href="group__xgPhatDir.html#ga17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga18">PhatDirRemove</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, char *path)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a specified subdirectory.  <a href="group__xgPhatDir.html#ga18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgPhatDir.html#ga19">PhatDirEntryStatus</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, CONST char *path, struct <a class="el" href="structstat.html">stat</a> *stp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve status of a specified file.  <a href="group__xgPhatDir.html#ga19"></a><br></td></tr>
</table>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2006 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
