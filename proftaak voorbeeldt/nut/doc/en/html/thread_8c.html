<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">ethernut-4.3.3</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_000001.html">nut</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_000025.html">os</a></div>
<h1>thread.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Multi-threading support. 
<p>
This kernel module implements the platform independent part of the Nut/OS cooperative multi-threading.<p>
<div class="fragment"><pre class="fragment"> *
 * $Log: thread.c,v $
 * Revision 1.28  2006/09/29 12:24:14  haraldkipp
 * Stack allocation code moved from thread module to heap module.
 * All code should use dedicated stack allocation routines. For targets
 * allocating stack from the normal heap the API calls are remapped by
 * preprocessor macros.
 *
 * Revision 1.27  2006/06/28 14:39:41  haraldkipp
 * Event and timer handling re-design, again.
 *
 * Revision 1.26  2006/03/16 15:25:36  haraldkipp
 * Changed human readable strings from u_char to char to stop GCC 4 from
 * nagging about signedness.
 *
 * Revision 1.25  2006/03/02 23:57:54  hwmaier
 * Fixed bug NutStackHeap* functions. The availabe variable was not
 * taken into account.
 *
 * Revision 1.24  2006/02/08 15:20:56  haraldkipp
 * ATmega2561 Support
 *
 * Revision 1.23  2006/01/26 15:34:49  going_nuts
 * adapted to new interrupt handling scheme for unix emulation
 * now uses Unix timer and runs without interrupts unless you emulate other hardware
 *
 * Revision 1.22  2005/10/04 05:14:49  hwmaier
 * Added support for separating stack and conventional heap as required by AT09CAN128 MCUs
 *
 * Revision 1.21  2005/07/26 16:00:16  haraldkipp
 * Cygwin added.
 * Platform dependent part is now located in arch/(target)/context.c
 *
 * Revision 1.20  2005/07/14 08:57:54  freckle
 * Rewrote CS in NutThreadSetPriority
 *
 * Revision 1.19  2005/07/12 13:57:56  freckle
 * Fixed bug in thread not waking up on NutSleep
 *
 * Revision 1.18  2005/06/12 16:56:20  haraldkipp
 * Calls new function to process elapsed timers.
 *
 * Revision 1.17  2005/05/27 17:30:26  drsung
 * Platform dependant files were moved to /arch directory.
 *
 * Revision 1.16  2005/04/19 14:15:28  phblum
 * Moved trace macro to avoid jamming the buffer with yields that do not switch to another thread (e.g. idle thread does so all the time).
 *
 * Revision 1.15  2005/02/21 12:37:57  phblum
 * Removed tabs and added semicolons after NUTTRACER macros
 *
 * Revision 1.14  2005/02/21 00:53:57  hwmaier
 * Changes to incorporate support for AT90CAN128 CPU
 *
 * Revision 1.13  2005/02/17 14:44:39  phblum
 * Removed volatile declarations of runQueue since it is not touched from interrupt context. Same for nutThreadList, runningThread and killedThreads.
 * As runQueue is not modified by interrupts, runningThread == runQueue always. Therefore removed obsolete comparison in NutThreadYield().
 * Removed unnecessary critical section in NutThreadYield.
 * Put NutThreadSwitch call of NutThreadResume into critical section.
 *
 * Revision 1.12  2005/02/16 19:53:17  haraldkipp
 * Ready-to-run queue handling removed from interrupt context.
 *
 * Revision 1.11  2005/01/24 22:34:36  freckle
 * Added new tracer by Phlipp Blum &lt;blum@tik.ee.ethz.ch&gt;
 *
 * Revision 1.10  2005/01/02 10:07:10  haraldkipp
 * Replaced platform dependant formats in debug outputs.
 *
 * Revision 1.9  2004/08/05 12:13:57  freckle
 * Added unix emulation hook in NutThreadYield to safely process
 * NutPostEventAsync calls occuring in non Nut/OS threads.
 * Rewrote the unix read function again using the new unix NutThreadYield hook
 * to call the NutPostEventAsync function safely (fast &amp; correct).
 * _write(nf, 0, 0) aka fflush is ignored on unix emulation.
 *
 * Revision 1.8  2004/04/07 12:13:58  haraldkipp
 * Matthias Ringwald's *nix emulation added
 *
 * Revision 1.7  2004/03/19 09:05:12  jdubiec
 * Fixed format strings declarations for AVR.
 *
 * Revision 1.6  2004/03/16 16:48:45  haraldkipp
 * Added Jan Dubiec's H8/300 port.
 *
 * Revision 1.5  2004/02/01 18:49:48  haraldkipp
 * Added CPU family support
 *
 * Revision 1.4  2003/12/15 19:31:46  haraldkipp
 * Ralph Mason's thread termination and reduced stack frame.
 *
 * Revision 1.3  2003/11/19 12:06:23  drsung
 * CR/LF issue corrected
 *
 * Revision 1.2  2003/11/18 22:18:40  drsung
 * thread name with 8 characters fixed.
 *
 * Revision 1.1.1.1  2003/05/09 14:41:54  haraldkipp
 * Initial using 3.2.1
 *
 * Revision 1.23  2003/05/06 18:56:24  harald
 * Avoid inlining with GCC optimizations
 *
 * Revision 1.22  2003/03/31 14:39:43  harald
 * *** empty log message ***
 *
 * Revision 1.21  2003/02/04 18:15:57  harald
 * Version 3 released
 *
 * Revision 1.20  2002/10/29 15:36:59  harald
 * New function retrieves thread by name
 *
 * Revision 1.19  2002/08/08 17:31:47  harald
 * Imagecraft support by Klaus Ummenhofer
 *
 * Revision 1.18  2002/07/03 16:45:42  harald
 * Using GCC 3.2
 *
 * Revision 1.17  2002/06/26 17:29:44  harald
 * First pre-release with 2.4 stack
 *
 * </pre></div>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga5">NutThreadAddPriQueue</a> (<a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *td, <a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *volatile *tqpp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a thread to a prioritiy ordered queue.  <a href="group__xgThread.html#ga5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga6">NutThreadRemoveQueue</a> (<a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *td, <a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *volatile *tqpp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a thread from a specified queue.  <a href="group__xgThread.html#ga6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga7">NutThreadResume</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Continue with the highest priority thread, which is ready to run.  <a href="group__xgThread.html#ga7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga8">NutThreadWake</a> (<a class="el" href="group__xgNutOS.html#ga5">HANDLE</a> timer, <a class="el" href="group__xgNutOS.html#ga5">HANDLE</a> th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume a previously suspended thread.  <a href="group__xgThread.html#ga8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga9">NutThreadYield</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Give up the CPU.  <a href="group__xgThread.html#ga9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">u_char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga10">NutThreadSetPriority</a> (u_char level)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the current thread's priority.  <a href="group__xgThread.html#ga10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga11">NutThreadExit</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">End the current thread.  <a href="group__xgThread.html#ga11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga12">NutThreadDestroy</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a thread that was previously killed and release memory back to the OS.  <a href="group__xgThread.html#ga12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga13">NutThreadKill</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Kill the running thread.  <a href="group__xgThread.html#ga13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__xgNutOS.html#ga5">HANDLE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga14">GetThreadByName</a> (char *name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Query handle of a thread with a specific name.  <a href="group__xgThread.html#ga14"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga1">runningThread</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Currently running thread.  <a href="group__xgThread.html#ga1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga2">killedThread</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread to be killed.  <a href="group__xgThread.html#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga3">nutThreadList</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of all created threads.  <a href="group__xgThread.html#ga3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__NUTTHREADINFO.html">NUTTHREADINFO</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgThread.html#ga4">runQueue</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of ready-to-run threads.  <a href="group__xgThread.html#ga4"></a><br></td></tr>
</table>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2006 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
