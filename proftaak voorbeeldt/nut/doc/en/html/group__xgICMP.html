<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>ICMP<br>
<small>
[<a class="el" href="group__xgBasePro.html">Base Protocols</a>]</small>
</h1>
<p>
Collaboration diagram for ICMP:<center><table><tr><td><img src="group__xgICMP.png" border="0" alt="" usemap="#group____xgICMP_map">
<map name="group____xgICMP_map">
<area href="group__xgBasePro.html" shape="rect" coords="19,5,117,26" alt="">
</map></td></tr></table></center>
<hr><a name="_details"></a><h2>Detailed Description</h2>
RFC 792 Internet Control Message Protocol. 
<p>
Provides routing, diagnostic and error functionality for IP. Although ICMP messages are encapsulated within IP datagrams, ICMP processing is considered to be part of the IP layer.<p>
There is currently no API support for this layer.
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgICMP.html#ga2">NutIcmpInput</a> (<a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *dev, <a class="el" href="struct__NETBUF.html">NETBUF</a> *nb)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle incoming ICMP packets.  <a href="#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgICMP.html#ga3">NutIcmpOutput</a> (u_char type, <a class="el" href="group__xgNutOS.html#ga3">u_long</a> dest, <a class="el" href="struct__NETBUF.html">NETBUF</a> *nb)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an ICMP datagram.  <a href="#ga3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgICMP.html#ga4">NutIcmpReply</a> (u_char type, u_char code, <a class="el" href="group__xgNutOS.html#ga3">u_long</a> spec, <a class="el" href="group__xgNutOS.html#ga3">u_long</a> dest, <a class="el" href="struct__NETBUF.html">NETBUF</a> *nb)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an ICMP message to a given destination.  <a href="#ga4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgICMP.html#ga5">NutIcmpResponse</a> (u_char type, u_char code, <a class="el" href="group__xgNutOS.html#ga3">u_long</a> spec, <a class="el" href="struct__NETBUF.html">NETBUF</a> *nb)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an ICMP message as a response to a given destination.  <a href="#ga5"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga2"></a><!-- doxytag: member="icmpin.c::NutIcmpInput" ref="ga2" args="(NUTDEVICE *dev, NETBUF *nb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void NutIcmpInput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct__NUTDEVICE.html">NUTDEVICE</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct__NETBUF.html">NETBUF</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>nb</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle incoming ICMP packets. 
<p>
Incoming ICMP packets are processed in the background. NutNet currently handles echo request and destination unreachable packets. Any other packet type is silently discarded.<p>
<dl compact><dt><b>Note:</b></dt><dd>This routine is called by the IP layer on incoming ICMP datagrams. Applications typically do not call this function.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev</em>&nbsp;</td><td>Identifies the device that received the packet. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>Pointer to a network buffer structure containing the ICMP datagram.</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga3"></a><!-- doxytag: member="icmpout.c::NutIcmpOutput" ref="ga3" args="(u_char type, u_long dest, NETBUF *nb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int NutIcmpOutput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u_char&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga3">u_long</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct__NETBUF.html">NETBUF</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>nb</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send an ICMP datagram. 
<p>
Known ICMP types are:<p>
<ul>
<li><a class="el" href="ip__icmp_8h.html#a0">ICMP_ECHOREPLY</a> Echo reply</li><li><a class="el" href="ip__icmp_8h.html#a1">ICMP_UNREACH</a> Destination unreachable</li><li><a class="el" href="ip__icmp_8h.html#a15">ICMP_SOURCEQUENCH</a> Packet lost</li><li><a class="el" href="ip__icmp_8h.html#a16">ICMP_REDIRECT</a> Shorter route</li><li><a class="el" href="ip__icmp_8h.html#a21">ICMP_ECHO</a> Echo reply</li><li><a class="el" href="ip__icmp_8h.html#a22">ICMP_ROUTERADVERT</a> Router advertisement</li><li><a class="el" href="ip__icmp_8h.html#a23">ICMP_ROUTERSOLICIT</a> Router solicitation</li><li><a class="el" href="ip__icmp_8h.html#a24">ICMP_TIMXCEED</a> Time exceeded</li><li><a class="el" href="ip__icmp_8h.html#a27">ICMP_PARAMPROB</a> Bad IP header</li><li><a class="el" href="ip__icmp_8h.html#a29">ICMP_TSTAMP</a> Timestamp request</li><li><a class="el" href="ip__icmp_8h.html#a30">ICMP_TSTAMPREPLY</a> Timestamp reply</li><li><a class="el" href="ip__icmp_8h.html#a31">ICMP_IREQ</a> Information request</li><li><a class="el" href="ip__icmp_8h.html#a32">ICMP_IREQREPLY</a> Information reply</li><li><a class="el" href="ip__icmp_8h.html#a33">ICMP_MASKREQ</a> Address mask request</li><li><a class="el" href="ip__icmp_8h.html#a34">ICMP_MASKREPLY</a> Address mask reply</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>Type of the ICMP message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>Destination IP address. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>Network buffer structure containing the datagram.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga4"></a><!-- doxytag: member="icmpout.c::NutIcmpReply" ref="ga4" args="(u_char type, u_char code, u_long spec, u_long dest, NETBUF *nb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int NutIcmpReply           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u_char&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_char&nbsp;</td>
          <td class="mdname" nowrap> <em>code</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga3">u_long</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>spec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga3">u_long</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct__NETBUF.html">NETBUF</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>nb</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send an ICMP message to a given destination. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>Type of the ICMP message. See <a class="el" href="group__xgICMP.html#ga3">NutIcmpOutput()</a> for a list of valid types. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>code</em>&nbsp;</td><td>Type subcode. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>spec</em>&nbsp;</td><td>Type specific data item. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>IP address of the target. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>Network buffer structure containing the message to be sent. The structure must have been allocated by a previous call <a class="el" href="group__xgnetbuf.html#ga4">NutNetBufAlloc()</a> and will be freed if this function returns with an error.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga5"></a><!-- doxytag: member="icmpout.c::NutIcmpResponse" ref="ga5" args="(u_char type, u_char code, u_long spec, NETBUF *nb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int NutIcmpResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">u_char&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_char&nbsp;</td>
          <td class="mdname" nowrap> <em>code</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga3">u_long</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>spec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="struct__NETBUF.html">NETBUF</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>nb</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send an ICMP message as a response to a given destination. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>Type of the ICMP message. See <a class="el" href="group__xgICMP.html#ga3">NutIcmpOutput()</a> for a list of valid types. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>code</em>&nbsp;</td><td>Type subcode. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>spec</em>&nbsp;</td><td>Type specific data item. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>Network buffer structure containing the previously recevied network packet. According to RFC792 the complete ip header and the first 8 bytes of the transport netbuf is used as the application data for the response. If this function returns with an error, the buffer is freed. The destination addess is taken from the ip header.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
    </td>
  </tr>
</table>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2006 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
