<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>Cypress CY2239x<br>
<small>
[<a class="el" href="group__xgDriver.html">Device Driver API.</a>,&nbsp;<a class="el" href="group__xgDevTiming.html">Clock Devices</a>]</small>
</h1>
<p>
Collaboration diagram for Cypress CY2239x:<center><table><tr><td><img src="group__xgCy2239x.png" border="0" alt="" usemap="#group____xgCy2239x_map">
<map name="group____xgCy2239x_map">
<area href="group__xgDriver.html" shape="rect" coords="17,6,129,27" alt="">
<area href="group__xgDevTiming.html" shape="rect" coords="27,51,120,72" alt="">
</map></td></tr></table></center>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Programmable clock generator with three PLLs. 
<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;dev/cy2239x.h&gt;</span>
</pre></div><p>
The CY22393 chip is used in the Ethernut 3 reference design. It provides three unique frequencies on six outputs, with an additional divider at five outputs.<p>
The following outputs are used on Ethernut 3:<p>
<ul>
<li>Clock A: 25 MHz, used by the Ethernet Controller.</li><li>Clock B: Disabled, connected to the GCK1 pin of the CPLD.</li><li>Clock C: 73.7288 MHz, used as the main CPU clock.</li><li>Clock D: Disabled, connected to the GCK3 pin of the CPLD.</li></ul>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga9">CY2239X_CLKA</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock A output.  <a href="#ga9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga10">CY2239X_CLKB</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock B output.  <a href="#ga10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga11">CY2239X_CLKC</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock C output.  <a href="#ga11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga12">CY2239X_CLKD</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock D output.  <a href="#ga12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga13">CY2239X_CLKE</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock E output.  <a href="#ga13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ga14"></a><!-- doxytag: member="xgCy2239x::CY2239X_REF" ref="ga14" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga14">CY2239X_REF</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reference clock identifier. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga15">CY2239X_PLL1</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PLL1 identifier.  <a href="#ga15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga16">CY2239X_PLL2</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PLL2 identifier.  <a href="#ga16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga17">CY2239X_PLL3</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">PLL3 identifier.  <a href="#ga17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ga18"></a><!-- doxytag: member="xgCy2239x::I2C_SLA_PLL" ref="ga18" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga18">I2C_SLA_PLL</a>&nbsp;&nbsp;&nbsp;0x69</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">I2C address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga19">NUT_PLL_FREF</a>&nbsp;&nbsp;&nbsp;25000000UL</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Base frequency.  <a href="#ga19"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga1">Cy2239xGetPll</a> (int clk)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the PLL connected to the specified output.  <a href="#ga1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga2">Cy2239xSetPll</a> (int clk, int pll)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Connect a specified PLL to a specified output.  <a href="#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga3">Cy2239xGetDivider</a> (int clk, int fctrl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the current divider value of the specified output.  <a href="#ga3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga4">Cy2239xSetDivider</a> (int clk, int sel, int val)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the divider value of the specified output.  <a href="#ga4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga5">Cy2239xPllEnable</a> (int pll, int fctrl, int ena)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable or disable a specified PLL.  <a href="#ga5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__xgNutOS.html#ga3">u_long</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga6">Cy2239xPllGetFreq</a> (int pll, int fctrl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the current frequency of a specified PLL.  <a href="#ga6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga7">Cy2239xPllSetFreq</a> (int pll, int fctrl, <a class="el" href="group__xgNutOS.html#ga2">u_int</a> pval, <a class="el" href="group__xgNutOS.html#ga2">u_int</a> poff, <a class="el" href="group__xgNutOS.html#ga2">u_int</a> qval, <a class="el" href="group__xgNutOS.html#ga2">u_int</a> fval)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the frequency of a specified PLL.  <a href="#ga7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__xgNutOS.html#ga3">u_long</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xgCy2239x.html#ga8">Cy2239xGetFreq</a> (int clk, int fctrl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the frequency of a specified output.  <a href="#ga8"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="ga9"></a><!-- doxytag: member="cy2239x.h::CY2239X_CLKA" ref="ga9" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_CLKA&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Clock A output. 
<p>
On Ethernut 3 this is output drives the Ethernet Controller, if R3 is mounted (default).    </td>
  </tr>
</table>
<a class="anchor" name="ga10"></a><!-- doxytag: member="cy2239x.h::CY2239X_CLKB" ref="ga10" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_CLKB&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Clock B output. 
<p>
On Ethernut 3 this is output drives the GCK1 input of the CPLD, if R6 is mounted (default).    </td>
  </tr>
</table>
<a class="anchor" name="ga11"></a><!-- doxytag: member="cy2239x.h::CY2239X_CLKC" ref="ga11" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_CLKC&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Clock C output. 
<p>
On Ethernut 3 this is output drives the CPU, if R5 is mounted (default).    </td>
  </tr>
</table>
<a class="anchor" name="ga12"></a><!-- doxytag: member="cy2239x.h::CY2239X_CLKD" ref="ga12" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_CLKD&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Clock D output. 
<p>
On Ethernut 3 this is output drives the GCK3 input of the CPLD, if R4 is mounted and R104 is not mounted (default).    </td>
  </tr>
</table>
<a class="anchor" name="ga13"></a><!-- doxytag: member="cy2239x.h::CY2239X_CLKE" ref="ga13" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_CLKE&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Clock E output. 
<p>
On Ethernut 3 this is output drives the GCK3 input of the CPLD, if R104 is mounted and R4 is not mounted. By default R104 is not mounted, but R4 is.    </td>
  </tr>
</table>
<a class="anchor" name="ga15"></a><!-- doxytag: member="cy2239x.h::CY2239X_PLL1" ref="ga15" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_PLL1&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
PLL1 identifier. 
<p>
The output of PLL1 can be connected to any output divider. Clock E output is fixed to PLL1.    </td>
  </tr>
</table>
<a class="anchor" name="ga16"></a><!-- doxytag: member="cy2239x.h::CY2239X_PLL2" ref="ga16" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_PLL2&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
PLL2 identifier. 
<p>
The output of PLL2 can be connected to the output divider of clock A, B, C or D.    </td>
  </tr>
</table>
<a class="anchor" name="ga17"></a><!-- doxytag: member="cy2239x.h::CY2239X_PLL3" ref="ga17" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CY2239X_PLL3&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
PLL3 identifier. 
<p>
The output of PLL3 can be connected to the output divider of clock A, B, C or D.    </td>
  </tr>
</table>
<a class="anchor" name="ga19"></a><!-- doxytag: member="cy2239x.c::NUT_PLL_FREF" ref="ga19" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define NUT_PLL_FREF&nbsp;&nbsp;&nbsp;25000000UL          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Base frequency. 
<p>
Frequency of the attached crystal. On Ethernut 3 a 25 MHz crystal is used.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga1"></a><!-- doxytag: member="cy2239x.c::Cy2239xGetPll" ref="ga1" args="(int clk)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Cy2239xGetPll           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>clk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the PLL connected to the specified output. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clk</em>&nbsp;</td><td>Specifies the output. 0 = ClkA, 1 = ClkB etc.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 for the reference clock, 1 for PLL1, 2 for PLL2 or 3 for PLL3. In case of an error -1 is returned.</dd></dl>
The following code fragment stores the number of the PLL connected to Clock Output C in the variable pll. <div class="fragment"><pre class="fragment"> <span class="keywordtype">int</span> pll;
 pll = <a class="code" href="group__xgCy2239x.html#ga1">Cy2239xGetPll</a>(<a class="code" href="group__xgCy2239x.html#ga11">CY2239X_CLKC</a>);
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="ga2"></a><!-- doxytag: member="cy2239x.c::Cy2239xSetPll" ref="ga2" args="(int clk, int pll)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Cy2239xSetPll           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>clk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pll</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Connect a specified PLL to a specified output. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Use with great care. This function may destroy your hardware.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clk</em>&nbsp;</td><td>Specifies the output. 0 = ClkA, 1 = ClkB etc. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pll</em>&nbsp;</td><td>1 - 3 for PLL1 - PLL3 resp. or 0 to select the reference clock.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
The following code can be used to connect PLL3 to Clock Output B. <div class="fragment"><pre class="fragment"> <span class="keywordflow">if</span> (<a class="code" href="group__xgCy2239x.html#ga2">Cy2239xSetPll</a>(<a class="code" href="group__xgCy2239x.html#ga10">CY2239X_CLKB</a>, <a class="code" href="group__xgCy2239x.html#ga17">CY2239X_PLL3</a>)) {
     <a class="code" href="group__xgCrtStdio.html#ga36">printf</a>(<span class="stringliteral">"Failed to select PLL3 for Clock B\n"</span>);
 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="ga3"></a><!-- doxytag: member="cy2239x.c::Cy2239xGetDivider" ref="ga3" args="(int clk, int fctrl)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Cy2239xGetDivider           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>clk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fctrl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the current divider value of the specified output. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clk</em>&nbsp;</td><td>Specifies the output. 0 = ClkA, 1 = ClkB etc. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fctrl</em>&nbsp;</td><td>Frequency control input status, only valid for clock A and B. Otherwise this parameter is ignored. For Ethernut 3 the inputs S0 and S1 are high and S2 is connected to the CPLD. Thus, this value is either 3 if control input S2 is low or 7 if S2 is set high (default).</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Clock's divider value. 0 means, that the output is switched off.</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga4"></a><!-- doxytag: member="cy2239x.c::Cy2239xSetDivider" ref="ga4" args="(int clk, int sel, int val)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Cy2239xSetDivider           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>clk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>val</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the divider value of the specified output. 
<p>
Clock A through D provide a 7-bit output divider, while the Clock E divider is fixed to 0 (off), 2, 3 or 4.<p>
Changing the divider value of an active output may cause a glitch on the output.<p>
<dl compact><dt><b>Note:</b></dt><dd>Use with great care. This function may destroy your hardware.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clk</em>&nbsp;</td><td>Specifies the output. 0 = ClkA, 1 = ClkB etc. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sel</em>&nbsp;</td><td>Divider select for Clock A and B, either 0 or 1. For other outputs this parameter is ignored. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>New divider value to set. A value of zero powers down the divider and forces the output to three-state.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga5"></a><!-- doxytag: member="cy2239x.c::Cy2239xPllEnable" ref="ga5" args="(int pll, int fctrl, int ena)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Cy2239xPllEnable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>pll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fctrl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ena</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Enable or disable a specified PLL. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pll</em>&nbsp;</td><td>Set to 1 - 3 for PLL1 - PLL3 resp. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fctrl</em>&nbsp;</td><td>Frequency control input status, only used for PLL1. Otherwise this parameter is ignored. For Ethernut 3 the inputs S0 and S1 are high and S2 is connected to the CPLD. Thus, this value is either 3 if control input S2 is low or 7 if S2 is set to high. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ena</em>&nbsp;</td><td>0 will disable the PLL, 1 will enable it. Any other value may be used to query the current status.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 if the PLL had been previously disabled, 1 if it had been enabled or -1 in case of an error.</dd></dl>
The following code shuts down PLL2 and Clock Output A. On Ethernut 3 this will remove the clock from the Ethernet Controller. <div class="fragment"><pre class="fragment"> <span class="keywordflow">if</span> (<a class="code" href="group__xgCy2239x.html#ga4">Cy2239xSetDivider</a>(<a class="code" href="group__xgCy2239x.html#ga9">CY2239X_CLKA</a>, 1, 0)) {
     <a class="code" href="group__xgCrtStdio.html#ga36">printf</a>(<span class="stringliteral">"Failed to disable ClkA Divider 1\n"</span>);
 }
 <span class="keywordflow">if</span> (<a class="code" href="group__xgCy2239x.html#ga5">Cy2239xPllEnable</a>(<a class="code" href="group__xgCy2239x.html#ga16">CY2239X_PLL2</a>, 7, 0)) {
     <a class="code" href="group__xgCrtStdio.html#ga36">printf</a>(<span class="stringliteral">"Failed to disable PLL2\n"</span>);
 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="ga6"></a><!-- doxytag: member="cy2239x.c::Cy2239xPllGetFreq" ref="ga6" args="(int pll, int fctrl)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="group__xgNutOS.html#ga3">u_long</a> Cy2239xPllGetFreq           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>pll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fctrl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the current frequency of a specified PLL. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pll</em>&nbsp;</td><td>1 - 3 for PLL1 - PLL3 resp. or 0 to query the reference clock. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fctrl</em>&nbsp;</td><td>Frequency control input status, only used for PLL1. Otherwise this parameter is ignored. For Ethernut 3 the inputs S0 and S1 are high and S2 is connected to the CPLD. Thus, this value is either 3 if control input S2 is low or 7 if S2 is set to high.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Frequency in Hertz.</dd></dl>
Use the following code to retrieve the reference clock: <div class="fragment"><pre class="fragment"> <a class="code" href="group__xgNutOS.html#ga3">u_long</a> fref;

 fref = <a class="code" href="group__xgCy2239x.html#ga6">Cy2239xPllGetFreq</a>(<a class="code" href="group__xgCy2239x.html#ga14">CY2239X_REF</a>, 7);
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="ga7"></a><!-- doxytag: member="cy2239x.c::Cy2239xPllSetFreq" ref="ga7" args="(int pll, int fctrl, u_int pval, u_int poff, u_int qval, u_int fval)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Cy2239xPllSetFreq           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>pll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fctrl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga2">u_int</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga2">u_int</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>poff</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga2">u_int</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>qval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__xgNutOS.html#ga2">u_int</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fval</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the frequency of a specified PLL. 
<p>
If the PLL is enabled, it will be temporarily disabled.<p>
The resulting frequency can calculated by <div class="fragment"><pre class="fragment"> F = Fref * (2 * (Pval + 3) + Poff) / (Qval + 2)
</pre></div><p>
It is recommended to use Cypress' CyClocksRT utility for calculating the best parameter values.<p>
<dl compact><dt><b>Note:</b></dt><dd>Use with great care. This function may destroy your hardware.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pll</em>&nbsp;</td><td>1 - 3 for PLL1 - PLL3 resp. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fctrl</em>&nbsp;</td><td>Frequency control input status, only valid for clock A and B. Otherwise this parameter is ignored. For Ethernut 3 the inputs S0 and S1 are high and S2 is connected to the CPLD. Thus, this value is either 3 if control input S2 is low or 7 if S2 is set to high. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pval</em>&nbsp;</td><td>10-bit multiplier. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>poff</em>&nbsp;</td><td>1-bit offset. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>qval</em>&nbsp;</td><td>8-bit divider. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fval</em>&nbsp;</td><td>2-bit loop filter value. This value corresponds to the multiplier value and guarantess the PLL stability.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga8"></a><!-- doxytag: member="cy2239x.c::Cy2239xGetFreq" ref="ga8" args="(int clk, int fctrl)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="group__xgNutOS.html#ga3">u_long</a> Cy2239xGetFreq           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>clk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fctrl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the frequency of a specified output. 
<p>
On Ethernut 3 Clock A provides the Ethernet Controller clock and Clock C is used as the CPU clock.<p>
PLL1 provides two configurations, selectable by the external input S2, which might be controlled by the Ethernut 3 CPLD. However, NPL version 2 doesn't allow to modify the S2 line, but holds it at a fixed high level.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clk</em>&nbsp;</td><td>Specifies the output. 0 = ClkA, 1 = ClkB etc. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fctrl</em>&nbsp;</td><td>Frequency control input status, only valid for clock A and B. Otherwise this parameter is ignored. For Ethernut 3 the inputs S0 and S1 are high and S2 is connected to the CPLD. Thus, this value is either 3 if control input S2 is low or 7 if S2 is set to high.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Frequency in Hertz. 0 is returned if the clock output is disabled or if an error occured.</dd></dl>
The following code can be used to query the main CPU clock on the Ethernut 3 board. <div class="fragment"><pre class="fragment"> <a class="code" href="group__xgNutOS.html#ga3">u_long</a> fcpu;

 fcpu = <a class="code" href="group__xgCy2239x.html#ga8">Cy2239xGetFreq</a>(<a class="code" href="group__xgCy2239x.html#ga11">CY2239X_CLKC</a>, 7);
</pre></div>    </td>
  </tr>
</table>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2006 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
